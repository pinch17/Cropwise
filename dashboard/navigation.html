<!-- Sidebar -->
<div id="sidebar"
  class="fixed left-0 top-0 h-full w-64 sidebar-bg shadow-xl z-40 transform -translate-x-full lg:translate-x-0 sidebar-transition border-r border-primary">
  <div class="p-6 border-b border-primary">
    <div class="flex items-center baa">
      <i class="fas fa-seedling text-green-600 text-2xl mr-3"></i>
      <h1 class="text-xl font-bold text-primary">CropWise</h1>
    </div>
    <p class="text-sm text-secondary mt-1">Smart Farming Assistant</p>
  </div>

  <div class="sidebar-content">
    <nav class="p-4">
      <ul class="space-y-2">
        <li>
          <a href="dashboard.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-home mr-3 w-5"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a href="disease-detection.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-search-plus mr-3 w-5"></i>
            <span>Disease Detection</span>
          </a>
        </li>
        <li>
          <a href="weather-advice.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-cloud-sun mr-3 w-5"></i>
            <span>Weather Advice</span>
          </a>
        </li>
        <li>
          <a href="growth-tracking.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-seedling mr-3 w-5"></i>
            <span>Growth Tracking</span>
          </a>
        </li>
        <li>
          <a href="market-prices.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-chart-line mr-3 w-5"></i>
            <span>Market Prices</span>
          </a>
        </li>
        <li>
          <a href="yield-prediction.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-calculator mr-3 w-5"></i>
            <span>Yield Prediction</span>
          </a>
        </li>
        <li>
          <a href="farm-records.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-clipboard-list mr-3 w-5"></i>
            <span>Farm Records</span>
          </a>
        </li>
        <li>
          <a href="ai-chat.html"
            class="nav-item flex items-center p-3 text-secondary hover:text-green-600 transition-colors duration-300">
            <i class="fas fa-comments mr-3 w-5"></i>
            <span>AI Chat Support</span>
          </a>
        </li>

        <!-- Add space before logout button -->
        <li style="height: 20px;"></li>

        <!-- Logout Button -->
        <li>
          <a href="#" id="logout-btn"
            class="nav-item flex items-center p-3 text-secondary hover:text-red-600 transition-colors duration-300">
            <i class="fas fa-sign-out-alt mr-3 w-5"></i>
            <span>Logout</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>

  <!-- Sidebar Profile -->
  <div class="sidebar-profile p-4 border-t border-primary sidebar-bg">
    <div class="flex items-center justify-between mb-3">
      <div class="flex items-center">
        <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center mr-3">
          <i class="fas fa-user text-white"></i>
        </div>
        <div>
          <p class="text-sm font-medium text-primary" id="sidebar-user-name">User</p>
          <p class="text-xs text-secondary">Premium Plan</p>
        </div>
      </div>
      <div class="theme-toggle hidden lg:block" id="desktop-theme-toggle" onclick="toggleTheme()">
        <i class="fas fa-sun theme-icon moon-icon"> </i>
        <i class="fas fa-moon theme-icon  sun-icon"></i>
       
      </div>
    </div>
  </div>
</div>

<!-- Overlay for mobile -->
<div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden lg:hidden transition-opacity duration-300">
</div>

<script>
  // Apply theme immediately when navigation loads
  (function() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    // Set toggle state based on saved theme
    const themeToggle = document.getElementById('desktop-theme-toggle');
    if (themeToggle) {
      if (savedTheme === 'dark') {
        themeToggle.classList.add('active');
      } else {
        themeToggle.classList.remove('active');
      }
    }
  })();
  
  // Theme toggle functionality
  function toggleTheme() {
    const currentTheme = document.documentElement.getAttribute("data-theme") || "dark";
    const newTheme = currentTheme === "dark" ? "light" : "dark";
    
    // Apply theme to document
    document.documentElement.setAttribute("data-theme", newTheme);
    
    // Update toggle state
    const themeToggle = document.getElementById('desktop-theme-toggle');
    if (themeToggle) {
      if (newTheme === "dark") {
        themeToggle.classList.add("active");
      } else {
        themeToggle.classList.remove("active");
      }
    }
    
    // Save to localStorage
    localStorage.setItem("theme", newTheme);
    
    // Save to Firebase if user is logged in
    const userData = getCurrentUserData();
    if (userData) {
      const emailKey = userData.email.replace(/\./g, "_");
      database.ref("users/" + emailKey).update({ theme: newTheme })
        .then(() => console.log("Theme saved to Firebase:", newTheme))
        .catch(error => console.error("Error saving theme to Firebase:", error));
    }
  }
  
  // Get current user data
  function getCurrentUserData() {
    try {
      const userData = localStorage.getItem("userData");
      return userData ? JSON.parse(userData) : null;
    } catch (e) {
      return null;
    }
  }
  
  // Set up event listener when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
    // Apply saved theme again to ensure it's set
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    // Set toggle state
    const themeToggle = document.getElementById('desktop-theme-toggle');
    if (themeToggle) {
      if (savedTheme === 'dark') {
        themeToggle.classList.add('active');
      } else {
        themeToggle.classList.remove('active');
      }
      
      // Add click event listener
      themeToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleTheme();
      });
    }
  });
  
  // Also set up event listener with a delay in case DOMContentLoaded already fired
  setTimeout(function() {
    const themeToggle = document.getElementById('desktop-theme-toggle');
    if (themeToggle && !themeToggle.hasAttribute('data-listener-added')) {
      themeToggle.setAttribute('data-listener-added', 'true');
      themeToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleTheme();
      });
    }
  }, 100);
</script>



